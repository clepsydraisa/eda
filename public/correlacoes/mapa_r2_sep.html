<!DOCTYPE html>
<html>
<head>
    
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.awesome-markers@2.0.2/leaflet.awesome-markers.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css"/>
    
            <meta name="viewport" content="width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
            <style>
                #map_5e8cd45bebb24c623d8bd3f1e72bd76d {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
                .leaflet-container { font-size: 1rem; }
            </style>

            <style>html, body {
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }
            </style>

            <style>#map {
                position:absolute;
                top:0;
                bottom:0;
                right:0;
                left:0;
                }
            </style>

            <script>
                L_NO_TOUCH = false;
                L_DISABLE_3D = false;
            </script>

        
</head>
<body>
    
    
                <div style="position: fixed; bottom: 24px; left: 24px; z-index: 9999; background: white; padding: 8px 10px; border: 1px solid #999; border-radius: 4px; font-size: 13px;">
                  <div style="font-weight: 600; margin-bottom: 4px;">caudal_lag1 (correlação)</div>
                  <div><span style="display:inline-block;width:12px;height:12px;background:red;margin-right:6px;border:1px solid #666;"></span>Fraca (|r| < 0.4)</div>
                  <div><span style="display:inline-block;width:12px;height:12px;background:yellow;margin-right:6px;border:1px solid #666;"></span>Moderada (0.4 ≤ |r| < 0.7)</div>
                  <div><span style="display:inline-block;width:12px;height:12px;background:green;margin-right:6px;border:1px solid #666;"></span>Forte (|r| ≥ 0.7)</div>
                </div>
                
            <!-- Filtro de Variáveis -->
            <div style="position: fixed; top: 10px; right: 10px; z-index: 9999; background: rgba(15,23,42,0.9); padding: 12px; border: 1px solid #374151; border-radius: 8px; font-size: 13px; color: #e2e8f0;">
                <div style="font-weight: 600; margin-bottom: 8px; color: #60a5fa;">Variável:</div>
                <select id="variableSelector" style="background: #1e293b; color: #e2e8f0; border: 1px solid #374151; border-radius: 4px; padding: 4px 8px; font-size: 12px;">
                    <option value="rr">rr</option>
                    <option value="eto">eto</option>
                    <option value="caudal">caudal</option>
                    <option value="rr_lag1">rr_lag1</option>
                    <option value="eto_lag1">eto_lag1</option>
                    <option value="caudal_lag1" selected>caudal_lag1</option>
                    <option value="rr_lag2">rr_lag2</option>
                    <option value="eto_lag2">eto_lag2</option>
                    <option value="caudal_lag2">caudal_lag2</option>
                </select>
            </div>

            <div class="folium-map" id="map_5e8cd45bebb24c623d8bd3f1e72bd76d" ></div>
        
</body>
<script>
    
    
            var map_5e8cd45bebb24c623d8bd3f1e72bd76d = L.map(
                "map_5e8cd45bebb24c623d8bd3f1e72bd76d",
                {
                    center: [39.087445250485565, -8.713070284908802],
                    crs: L.CRS.EPSG3857,
                    ...{
  "zoom": 10,
  "zoomControl": true,
  "preferCanvas": false,
}

                }
            );

            

        
    
            var tile_layer_404ac902e0b0e77b345aad2715fa12ed = L.tileLayer(
                "https://tile.openstreetmap.org/{z}/{x}/{y}.png",
                {
  "minZoom": 0,
  "maxZoom": 19,
  "maxNativeZoom": 19,
  "noWrap": false,
  "attribution": "\u0026copy; \u003ca href=\"https://www.openstreetmap.org/copyright\"\u003eOpenStreetMap\u003c/a\u003e contributors",
  "subdomains": "abc",
  "detectRetina": false,
  "tms": false,
  "opacity": 1,
}

            );
        
    
            tile_layer_404ac902e0b0e77b345aad2715fa12ed.addTo(map_5e8cd45bebb24c623d8bd3f1e72bd76d);

            // Dados completos de todos os poços com todas as variáveis
            var wellsData = [
                {poco: "418/15", n: 221, lat: 38.83265702070208, lng: -8.91322764738625, 
                 rr: -0.39458688, eto: 0.345619986, caudal: -0.5331796, 
                 rr_lag1: -0.5755112, rr_lag2: -0.5550723, eto_lag1: 0.5297694, eto_lag2: 0.5771113, 
                 caudal_lag1: -0.5053783, caudal_lag2: -0.3773139},
                {poco: "391/33", n: 219, lat: 39.00226813788561, lng: -8.747933204359521, 
                 rr: 0.07987517, eto: -0.142860734, caudal: -0.3928869, 
                 rr_lag1: -0.1565055, rr_lag2: -0.3203109, eto_lag1: 0.0399141, eto_lag2: 0.2205747, 
                 caudal_lag1: -0.5098157, caudal_lag2: -0.5252032},
                {poco: "377/94", n: 217, lat: 39.074721547571784, lng: -8.729391145758276, 
                 rr: 0.03043202, eto: -0.036058869, caudal: -0.3156599, 
                 rr_lag1: -0.200564, rr_lag2: -0.3068387, eto_lag1: 0.1334752, eto_lag2: 0.2611029, 
                 caudal_lag1: -0.397839, caudal_lag2: -0.422514},
                {poco: "330/183", n: 211, lat: 39.40575877141178, lng: -8.470033181712429, 
                 rr: -0.41398369, eto: 0.381072041, caudal: -0.3906368, 
                 rr_lag1: -0.423802, rr_lag2: -0.286411, eto_lag1: 0.4145779, eto_lag2: 0.3132127, 
                 caudal_lag1: -0.3638154, caudal_lag2: -0.2182988},
                {poco: "405/17", n: 207, lat: 38.940885172460284, lng: -8.864356154052757, 
                 rr: -0.52451448, eto: 0.585193883, caudal: -0.4920794, 
                 rr_lag1: -0.648556, rr_lag2: -0.4989669, eto_lag1: 0.7520774, eto_lag2: 0.7095621, 
                 caudal_lag1: -0.3854239, caudal_lag2: -0.2399897},
                {poco: "377/86", n: 193, lat: 39.075974920185885, lng: -8.776538255637428, 
                 rr: -0.6000832, eto: 0.778513698, caudal: -0.435107, 
                 rr_lag1: -0.6142228, rr_lag2: -0.4366756, eto_lag1: 0.8752685, eto_lag2: 0.7502787, 
                 caudal_lag1: -0.3780677, caudal_lag2: -0.1996851},
                {poco: "341/17", n: 190, lat: 39.35277835821799, lng: -8.532890066936835, 
                 rr: -0.0536011, eto: -0.003613816, caudal: -0.3970701, 
                 rr_lag1: -0.2976776, rr_lag2: -0.4410857, eto_lag1: 0.3172355, eto_lag2: 0.5516296, 
                 caudal_lag1: -0.5289906, caudal_lag2: -0.5332229},
                {poco: "418/4", n: 178, lat: 38.809989914061276, lng: -8.880744515837215, 
                 rr: -0.19285871, eto: 0.121830444, caudal: -0.4513311, 
                 rr_lag1: -0.5264127, rr_lag2: -0.6324332, eto_lag1: 0.4715947, eto_lag2: 0.6840475, 
                 caudal_lag1: -0.5193071, caudal_lag2: -0.4086704},
                {poco: "391/437", n: 165, lat: 38.99222363063388, lng: -8.78138803751802, 
                 rr: -0.42041221, eto: 0.509014795, caudal: -0.5433655, 
                 rr_lag1: -0.5871141, rr_lag2: -0.5560984, eto_lag1: 0.751177, eto_lag2: 0.8022636, 
                 caudal_lag1: -0.57246, caudal_lag2: -0.4708104},
                {poco: "404/69", n: 136, lat: 38.863026334386426, lng: -8.88371955375627, 
                 rr: -0.43785541, eto: 0.328002596, caudal: -0.4999994, 
                 rr_lag1: -0.6352996, rr_lag2: -0.6101171, eto_lag1: 0.615798, eto_lag2: 0.7331502, 
                 caudal_lag1: -0.4178653, caudal_lag2: -0.3274989},
                {poco: "391/243", n: 102, lat: 38.958420853785334, lng: -8.76116714156585, 
                 rr: -0.25717851, eto: 0.286713584, caudal: -0.4265474, 
                 rr_lag1: -0.3542566, rr_lag2: -0.3773108, eto_lag1: 0.3866918, eto_lag2: 0.3715594, 
                 caudal_lag1: -0.4938065, caudal_lag2: -0.3753934},
                {poco: "342/78", n: 93, lat: 39.347355693206914, lng: -8.482744684063292, 
                 rr: -0.33825144, eto: 0.39176819, caudal: -0.4145299, 
                 rr_lag1: -0.4478026, rr_lag2: -0.4431408, eto_lag1: 0.5258187, eto_lag2: 0.5199379, 
                 caudal_lag1: -0.4677972, caudal_lag2: -0.2327497},
                {poco: "331/2", n: 80, lat: 39.479497741719065, lng: -8.265693632680588, 
                 rr: -0.13317689, eto: 0.173181089, caudal: -0.6174823, 
                 rr_lag1: -0.4163906, rr_lag2: -0.4882777, eto_lag1: 0.3622242, eto_lag2: 0.4794837, 
                 caudal_lag1: -0.6527117, caudal_lag2: -0.5245024},
                {poco: "405/34", n: 79, lat: 38.866515337266826, lng: -8.829476761549785, 
                 rr: -0.05958831, eto: 0.007260798, caudal: -0.5785111, 
                 rr_lag1: -0.4292972, rr_lag2: -0.4848609, eto_lag1: 0.25145, eto_lag2: 0.3908354, 
                 caudal_lag1: -0.7171532, caudal_lag2: -0.4732332},
                {poco: "390/208", n: 75, lat: 39.0057362409088, lng: -8.949371863688773, 
                 rr: -0.15781184, eto: 0.080432885, caudal: -0.3978502, 
                 rr_lag1: -0.4436523, rr_lag2: -0.5158232, eto_lag1: 0.4244049, eto_lag2: 0.6311611, 
                 caudal_lag1: -0.4785678, caudal_lag2: -0.420475},
                {poco: "377/54", n: 74, lat: 39.0978391370536, lng: -8.74586176968888, 
                 rr: -0.51675604, eto: 0.640792258, caudal: -0.4289132, 
                 rr_lag1: -0.5540184, rr_lag2: -0.4318987, eto_lag1: 0.817326, eto_lag2: 0.789832, 
                 caudal_lag1: -0.4136552, caudal_lag2: -0.3314841},
                {poco: "342/97", n: 57, lat: 39.366553617966304, lng: -8.478431140589214, 
                 rr: -0.4601222, eto: 0.302892798, caudal: -0.7483996, 
                 rr_lag1: -0.3622308, rr_lag2: -0.1351702, eto_lag1: 0.2543392, eto_lag2: 0.062264, 
                 caudal_lag1: -0.4091403, caudal_lag2: -0.209513},
                {poco: "377/84", n: 48, lat: 39.10181207931643, lng: -8.74229637157708, 
                 rr: -0.64436783, eto: 0.647775703, caudal: -0.281356, 
                 rr_lag1: -0.5586183, rr_lag2: -0.3529316, eto_lag1: 0.8401053, eto_lag2: 0.8085661, 
                 caudal_lag1: -0.1854898, caudal_lag2: -0.1113373}
            ];

            // Função para determinar a cor baseada no valor absoluto
            function getColorForValue(value) {
                var absValue = Math.abs(value);
                if (absValue < 0.4) return "red";
                if (absValue < 0.7) return "yellow";
                return "green";
            }

            // Função para atualizar a legenda
            function updateLegend(variable) {
                var legend = document.querySelector('div[style*="position: fixed; bottom: 24px"]');
                legend.innerHTML = '<div style="font-weight: 600; margin-bottom: 4px;">' + variable + ' (correlação)</div>' +
                                 '<div><span style="display:inline-block;width:12px;height:12px;background:red;margin-right:6px;border:1px solid #666;"></span>Fraca (|r| < 0.4)</div>' +
                                 '<div><span style="display:inline-block;width:12px;height:12px;background:yellow;margin-right:6px;border:1px solid #666;"></span>Moderada (0.4 ≤ |r| < 0.7)</div>' +
                                 '<div><span style="display:inline-block;width:12px;height:12px;background:green;margin-right:6px;border:1px solid #666;"></span>Forte (|r| ≥ 0.7)</div>';
            }

            // Função para criar marcadores
            function createMarkers(variable) {
                // Limpar marcadores existentes
                map_5e8cd45bebb24c623d8bd3f1e72bd76d.eachLayer(function(layer) {
                    if (layer instanceof L.CircleMarker) {
                        map_5e8cd45bebb24c623d8bd3f1e72bd76d.removeLayer(layer);
                    }
                });

                // Criar novos marcadores
                wellsData.forEach(function(well) {
                    var value = well[variable];
                    var color = getColorForValue(value);
                    
                    var marker = L.circleMarker([well.lat, well.lng], {
                        "bubblingMouseEvents": true, 
                        "color": color, 
                        "dashArray": null, 
                        "dashOffset": null, 
                        "fill": true, 
                        "fillColor": color, 
                        "fillOpacity": 0.85, 
                        "fillRule": "evenodd", 
                        "lineCap": "round", 
                        "lineJoin": "round", 
                        "opacity": 1.0, 
                        "radius": 6, 
                        "stroke": true, 
                        "weight": 3
                    }).addTo(map_5e8cd45bebb24c623d8bd3f1e72bd76d);

                    var popup = L.popup({"maxWidth": 320});
                    var html = '<div style="width: 100.0%; height: 100.0%;">' +
                              '<b>Poço:</b> ' + well.poco + '<br>' +
                              '<b>N:</b> ' + well.n + '<br>' +
                              '<b>' + variable + ':</b> ' + value.toFixed(3) + '<br>' +
                              '<b>CRS origem:</b> ESRI:102164</div>';
                    popup.setContent(html);
                    marker.bindPopup(popup);
                });
            }

            // Event listener para mudança de variável
            document.getElementById('variableSelector').addEventListener('change', function() {
                var selectedVariable = this.value;
                updateLegend(selectedVariable);
                createMarkers(selectedVariable);
            });

            // Inicializar com caudal_lag1
            updateLegend('caudal_lag1');
            createMarkers('caudal_lag1');
    
</script>
</html>